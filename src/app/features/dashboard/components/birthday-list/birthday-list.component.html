<mat-card class="birthday-list-card">
  <mat-card-header class="birthday-list-header">
    <div class="header-title-section">
      <mat-card-title>ðŸ“… All Upcoming Birthdays</mat-card-title>
      @if (lastAction) {
        <button
          mat-raised-button
          color="accent"
          (click)="onUndo()"
          class="undo-button-enhanced"
          matTooltip="Undo last action"
          aria-label="Undo last action"
          >
          <mat-icon>undo</mat-icon>
          UNDO
        </button>
      }
    </div>
    <div class="header-search-section">
      <mat-form-field appearance="fill" class="dashboard-search-field">
        <mat-label>Search by name</mat-label>
        <input
          matInput
          placeholder="Type to search..."
          (input)="onSearchChange($event)"
          [value]="searchTerm"
          />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>
  </mat-card-header>
  <mat-card-content>
    @if (enrichedBirthdays.length > 0) {
      <div
        class="dashboard-birthday-list scrollable"
        >
        @for (birthday of enrichedBirthdays; track birthday.id) {
          <app-birthday-item
            [birthday]="birthday"
            [daysUntilBirthday]="birthday.daysUntilBirthday"
            (edit)="editBirthday($event)"
            (deleted)="deleteBirthday($event)"
          ></app-birthday-item>
        }
      </div>
    }

    @if (birthdays.length === 0 && searchTerm) {
      <div class="no-birthdays">
        <mat-icon class="no-data-icon">search_off</mat-icon>
        <p class="no-data-text">No birthdays found matching "{{ searchTerm }}"</p>
        <button mat-raised-button color="primary" (click)="onClearSearch()">
          <mat-icon>clear</mat-icon>
          Clear Search
        </button>
      </div>
    }

    @if (birthdays.length === 0 && !searchTerm && totalBirthdays === 0) {
      <div class="no-birthdays">
        <mat-icon class="no-data-icon">cake</mat-icon>
        <p class="no-data-text">No birthdays yet. Add your first one!</p>
      </div>
    }
  </mat-card-content>
</mat-card>

@if (totalBirthdays === 0) {
  <div class="test-data-section">
    <mat-card class="test-data-card">
      <mat-card-content>
        <div class="test-data-content">
          <mat-icon class="test-icon">science</mat-icon>
          <div class="test-info">
            <h3>Want to try the app?</h3>
            <p>Add 10 sample birthdays with photos to test all features</p>
          </div>
          <button
            mat-raised-button
            color="primary"
            (click)="onAddTestData()"
            [disabled]="isAddingTestData"
            class="add-test-btn"
            >
            <mat-icon>add_circle</mat-icon>
            {{ isAddingTestData ? 'Adding...' : 'Add Test Data' }}
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
}

@if (totalBirthdays > 0) {
  <div class="data-management-sections">
    <app-birthday-import-export
      [totalBirthdays]="totalBirthdays"
      [allBirthdays]="birthdays"
      (birthdaysImported)="onBirthdaysImported($event)"
    ></app-birthday-import-export>

    <div class="clear-data-section">
      <mat-card class="clear-data-card">
        <mat-card-content>
          <div class="clear-data-content">
            <mat-icon class="clear-icon">delete_sweep</mat-icon>
            <div class="clear-info">
              <h3>Clear All Data</h3>
              <p>Remove all birthdays from the app</p>
            </div>
            <button
              mat-raised-button
              color="warn"
              (click)="onClearAllData()"
              [disabled]="isClearingData"
              class="clear-all-btn"
              >
              <mat-icon>delete_forever</mat-icon>
              {{ isClearingData ? 'Clearing...' : 'Clear All' }}
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
}
